<!DOCTYPE html>
<html lang="pt-BR">
  <head>
    <meta charset="UTF-8" />
    <title>ZEBROL</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <!-- React -->
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>

    <!-- Firebase -->
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>

    <!-- Tailwind -->
    <script src="https://cdn.tailwindcss.com"></script>
  </head>

  <body class="bg-black text-white">
    <div id="root"></div>

    <script>
      const firebaseConfig = {
        apiKey: "SUA_API_KEY",
        authDomain: "zebrol.firebaseapp.com",
        projectId: "zebrol",
      };

      firebase.initializeApp(firebaseConfig);
      const auth = firebase.auth();
      const db = firebase.firestore();
    </script>

    <script type="text/javascript">
      const { useState, useEffect } = React;

      function App() {
        const [items, setItems] = useState([]);
        const [selected, setSelected] = useState(null);
        const [search, setSearch] = useState("");

        useEffect(() => {
          auth.signInAnonymously();

          db.collection("pessoas").onSnapshot((snap) => {
            const data = snap.docs.map((d) => ({ id: d.id, ...d.data() }));
            data.sort((a, b) => a.name.localeCompare(b.name));
            setItems(data);
          });
        }, []);

        const filtered = items.filter((i) =>
          [i.name, i.vulgo, i.faccao]
            .join(" ")
            .toLowerCase()
            .includes(search.toLowerCase())
        );

        return (
          <div className="p-4 space-y-4">
            <h1 className="text-3xl font-bold text-center">ZEBROL</h1>

            {search && (
              <input
                className="w-full p-2 rounded bg-gray-800"
                placeholder="Buscar por nome, vulgo ou fac√ß√£o"
                value={search}
                onChange={(e) => setSearch(e.target.value)}
              />
            )}

            <div className="grid grid-cols-2 gap-4 max-w-md mx-auto">
              {filtered.map((item) => (
                <div
                  key={item.id}
                  onClick={() => setSelected(item)}
                  className="bg-gray-900 rounded-xl p-3 cursor-pointer"
                >
                  <div className="h-32 bg-gray-700 rounded overflow-hidden mb-2">
                    {item.image && (
                      <img
                        src={item.image}
                        className="w-full h-full object-cover"
                      />
                    )}
                  </div>
                  <p className="text-center font-semibold">{item.name}</p>
                </div>
              ))}
            </div>

            {/* MODAL DETALHES */}
            {selected && (
              <div className="fixed inset-0 bg-black/80 flex items-center justify-center p-4 z-50">
                <div className="bg-gray-900 p-4 rounded-xl max-w-sm w-full space-y-2 relative">
                  <button
                    onClick={() => setSelected(null)}
                    className="absolute top-2 right-3 text-red-400"
                  >
                    Fechar
                  </button>

                  {selected.image && (
                    <img
                      src={selected.image}
                      className="w-full max-h-64 object-contain rounded"
                    />
                  )}

                  <p><b>Nome:</b> {selected.name}</p>
                  <p><b>Vulgo:</b> {selected.vulgo}</p>
                  <p><b>Fac√ß√£o:</b> {selected.faccao}</p>
                  <p><b>CPF:</b> {selected.cpf}</p>
                  <p><b>Nascimento:</b> {selected.birth}</p>
                  <p><b>M√£e:</b> {selected.mother}</p>
                  <p><b>Endere√ßo:</b> {selected.address}</p>
                  <p><b>Descri√ß√£o:</b> {selected.description}</p>
                </div>
              </div>
            )}

            {/* LUPA */}
            <button
              onClick={() => setSearch(search ? "" : "")}
              className="fixed bottom-6 left-6 text-3xl"
            >
              üîç
            </button>
          </div>
        );
      }

      ReactDOM.createRoot(document.getElementById("root")).render(<App />);
    </script>
  </body>
</html>
