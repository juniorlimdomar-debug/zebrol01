<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <title>ZEBROL</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <!-- React -->
  <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

  <!-- Tailwind -->
  <script src="https://cdn.tailwindcss.com"></script>

  <!-- Firebase -->
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
    import { getAuth, signInWithEmailAndPassword } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-auth.js";
    import { getFirestore, collection, getDocs } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js";

    window.firebaseModules = {
      initializeApp,
      getAuth,
      signInWithEmailAndPassword,
      getFirestore,
      collection,
      getDocs
    };
  </script>
</head>

<body class="bg-black">
  <div id="root"></div>

  <script type="text/babel">
    const { useState, useEffect } = React;

    function App() {
      const [logged, setLogged] = useState(false);
      const [password, setPassword] = useState("");
      const [items, setItems] = useState([]);
      const [selected, setSelected] = useState(null);
      const [search, setSearch] = useState("");

      useEffect(() => {
        const { initializeApp, getFirestore, collection, getDocs } = window.firebaseModules;

        const app = initializeApp({
          apiKey: "AIzaSyBAH2rBIR5ibvde0VMVF38QyM4L2s8IqIQ",
          authDomain: "zebrol.firebaseapp.com",
          projectId: "zebrol"
        });

        const db = getFirestore(app);

        getDocs(collection(db, "pessoas")).then(snapshot => {
          const data = snapshot.docs.map(doc => ({ id: doc.id, ...doc.data() }));
          setItems(data);
        });
      }, []);

      if (!logged) {
        return (
          <div className="min-h-screen flex items-center justify-center">
            <div className="bg-gray-900 p-6 rounded-xl w-72 space-y-4">
              <h1 className="text-white text-xl text-center font-bold">ZEBROL</h1>
              <input
                type="password"
                inputMode="numeric"
                placeholder="Senha"
                className="w-full p-2 rounded bg-gray-800 text-white"
                value={password}
                onChange={e => setPassword(e.target.value)}
              />
              <button
                onClick={() => password === "1234" && setLogged(true)}
                className="w-full bg-blue-600 p-2 rounded font-semibold"
              >
                Entrar
              </button>
            </div>
          </div>
        );
      }

      const filtered = items
        .filter(i =>
          [i.name, i.vulgo, i.faccao].join(" ").toLowerCase().includes(search.toLowerCase())
        )
        .sort((a, b) => a.name.localeCompare(b.name));

      return (
        <div className="min-h-screen text-white p-6 space-y-6">
          <h1 className="text-3xl font-bold text-center">ZEBROL</h1>

          <input
            placeholder="Pesquisar..."
            className="w-full max-w-md mx-auto block bg-gray-800 p-2 rounded"
            value={search}
            onChange={e => setSearch(e.target.value)}
          />

          <div className="grid grid-cols-2 gap-4 max-w-md mx-auto">
            {filtered.map(item => (
              <div
                key={item.id}
                onClick={() => setSelected(item)}
                className="bg-gray-900 p-4 rounded-xl cursor-pointer hover:bg-gray-800"
              >
                <div className="h-32 bg-gray-700 rounded mb-2 overflow-hidden">
                  {item.image && (
                    <img src={item.image} className="w-full h-full object-cover" />
                  )}
                </div>
                <p className="text-center font-semibold">{item.name}</p>
              </div>
            ))}
          </div>

          {selected && (
            <div className="fixed inset-0 bg-black bg-opacity-80 flex items-center justify-center p-4 z-50">
              <div className="bg-gray-900 p-6 rounded-xl max-w-sm w-full space-y-3">
                <button
                  className="text-red-400 text-sm float-right"
                  onClick={() => setSelected(null)}
                >
                  Fechar
                </button>

                {selected.image && (
                  <img
                    src={selected.image}
                    className="w-full h-56 object-contain bg-black rounded"
                  />
                )}

                <p><b>Nome:</b> {selected.name}</p>
                <p><b>Vulgo:</b> {selected.vulgo}</p>
                <p><b>Facção:</b> {selected.faccao}</p>
                <p><b>CPF:</b> {selected.cpf}</p>
                <p><b>Nascimento:</b> {selected.birth}</p>
                <p><b>Mãe:</b> {selected.mother}</p>
                <p><b>Endereço:</b> {selected.address}</p>
                <p><b>Descrição:</b> {selected.description}</p>
              </div>
            </div>
          )}
        </div>
      );
    }

    ReactDOM.createRoot(document.getElementById("root")).render(<App />);
  </script>
</body>
</html>
